@{
    BACHHOA_ONLINEContext db = new BACHHOA_ONLINEContext();
    List<Loai> listLoai = db.Loai.Take(14).ToList();
}
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor;
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <title>@ViewData["Title"] - BÁCH HÓA ONLINE</title>

    <!-- Google font -->
    <link href="https://fonts.googleapis.com/css?family=Hind:400,700" rel="stylesheet">


    <!-- Bootstrap -->
    <link href="~/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Slick -->
    <link href="~/css/slick.css" rel="stylesheet" />
    <link href="~/css/slick-theme.css" rel="stylesheet" />

    <!-- nouislider -->
    <link href="~/css/nouislider.min.css" rel="stylesheet" />

    <!-- Font Awesome Icon -->
    <link href="~/css/font-awesome.min.css" rel="stylesheet" />

    <!-- Custom stlylesheet -->
    <link href="~/css/style.css" rel="stylesheet" />

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

</head>
<body>
    <!-- HEADER -->
    <header>
        <!-- header -->
        <div id="header">
            <div class="container">
                <div class="pull-left">
                    <!-- Logo -->
                    <div class="header-logo">
                        <a class="logo" href="#">
                            Bách Hóa Online
                        </a>
                    </div>
                    <!-- /Logo -->
                </div>
                <div class="pull-right">
                    <ul class="header-btns">
                        <!-- Account -->
                        <li class="header-account dropdown default-dropdown" id="accountt">
                            @{ string user = HttpContextAccessor.HttpContext.Session.Get<string>("user");}
                            <div class="dropdown-toggle" role="button" data-toggle="dropdown" aria-expanded="true">
                                <div class="header-btns-icon">
                                    <i class="fa fa-user-o"></i>
                                </div>
                                @if (user != null)
                                {
                                    <strong class="text-uppercase">@user <i class="fa fa-caret-down"></i></strong>
                                }
                                else
                                {
                                    <strong class="text-uppercase">Tài khoản của tôi<i class="fa fa-caret-down"></i></strong>
                                }
                            </div>
                            @if (user == null)
                            {
                                <a href="/dang-nhap" class="text-uppercase">Đăng nhập</a>
                                <a href="/dang-ky" class="text-uppercase">Đăng ký</a>
                            }
                            else
                            {
                                <a href="/dang-xuat" class="text-uppercase">Đăng xuất</a>
                            }
                            <ul class="custom-menu">
                                @if (user != null)
                                {
                                    <li><a href="/thong-tin-ca-nhan"><i class="fa fa-user-o"></i> Thông tin tài khoản</a></li>
                                    <li><a href="#"><i class="fa fa-heart-o"></i> My Wishlist</a></li>
                                    <li><a href="/thong-tin-ca-nhan"><i class="fa fa-check"></i> Lịch sử mua hàng</a></li>
                                    <li><a href="/dang-xuat"><i class="fa fa-unlock-alt"></i> Đăng xuất</a></li>
                                }
                                else
                                {
                                    <li><a href="/dang-nhap"><i class="fa fa-unlock-alt"></i> Đăng nhập</a></li>
                                    <li><a href="/dang-ky"><i class="fa fa-user-plus"></i> Đăng ký</a></li>
                                }
                            </ul>
                        </li>
                        <!-- /Account -->
                        <!-- Cart -->
                        @{
                            List<CartItem> listItem = HttpContextAccessor.HttpContext.Session.Get<List<CartItem>>("gioHang");
                            float total = 0;
                            float qty = 0;
                        }
                        <li class="header-cart dropdown default-dropdown" id="cartt">
                            <a class="dropdown-toggle" data-toggle="dropdown" aria-expanded="true">
                                <div class="header-btns-icon">
                                    <i class="fa fa-shopping-cart"></i>
                                    <span class="qty" id="cart-count">@{if (listItem != null) { qty = listItem.Count(); } } @qty</span>
                                </div>
                                <strong class="text-uppercase">Giỏ hàng:</strong>
                                <br>
                                <span id="cart-total">@{if (listItem != null) { total = listItem.Sum(x => x.ThanhTien); }} @total</span>
                            </a>
                            <div class="custom-menu">
                                <div id="shopping-cart">
                                    <div class="shopping-cart-list">
                                        @{
                                            if (listItem != null)
                                            {
                                                foreach (var item in listItem)
                                                {
                                                    <div class="product product-widget">
                                                        <div class="product-thumb">
                                                            <img src="~/images/@item.Hinh" alt="">
                                                        </div>
                                                        <div class="product-body">
                                                            <h3 class="product-price">@item.Dongia <span class="qty"> x @item.Soluong</span></h3>
                                                            <h2 class="product-name"><a href="#">@item.Tensp</a></h2>
                                                        </div>
                                                        <button class="cancel-btn"><i class="fa fa-trash"></i></button>
                                                    </div>
                                                }
                                            }
                                        }
                                    </div>
                                    <div class="shopping-cart-btns">
                                        <a href="/gio-hang" class="main-btn">Xem giỏ hàng</a>
                                        <a href="/thanh-toan" class="primary-btn">Thanh toán <i class="fa fa-arrow-circle-right"></i></a>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <!-- /Cart -->
                        <!-- Mobile nav toggle-->
                        <li class="nav-toggle">
                            <button class="nav-toggle-btn main-btn icon-btn"><i class="fa fa-bars"></i></button>
                        </li>
                        <!-- / Mobile nav toggle -->
                    </ul>
                </div>
            </div>
            <!-- header -->
        </div>
        <!-- container -->
    </header>
    <!-- /HEADER -->
    <!-- NAVIGATION -->
    <div id="navigation">
        <!-- container -->
        <div class="container">
            <div id="responsive-nav">
                <!-- category nav -->
                <div class="category-nav">
                    <span class="category-header">Danh mục sản phẩm <i class="fa fa-list"></i></span>
                    <ul class="category-list" id="abc">
                        @foreach (var l in listLoai)
                        {
                            <li><a href="@Url.Action("Shop","Home",l.Maloai)">@l.Tenloai</a></li>
                        }
                    </ul>
                </div>
                <!-- /category nav -->
                <!-- menu nav -->
                <div class="menu-nav">
                    <span class="menu-header">Menu <i class="fa fa-bars"></i></span>
                    <ul class="menu-list">
                        <li><a href="@Url.Action("Index","Home")">Trang chủ</a></li>
                        <li><a href="@Url.Action("Shop","Home")">Sản phẩm</a></li>
                        <li><a href="@Url.Action("Index","Cart")">Giỏ hàng</a></li>
                        <li><a href="@Url.Action("Index","CheckOut")">Thanh toán</a></li>
                    </ul>
                </div>
                <!-- menu nav -->
            </div>
        </div>
        <!-- /container -->
    </div>
    <!-- /NAVIGATION -->

    <partial name="_CookieConsentPartial" />

    <div class="container body-content">
        @RenderBody()
    </div>

    <!-- FOOTER -->
    <footer id="footer" class="section section-grey">
        <!-- container -->
        <div class="container">
            <!-- row -->
            <div class="row">
                <!-- footer widget -->
                <div class="col-md-4 col-sm-6 col-xs-6">
                    <div class="footer">
                        <!-- footer logo -->
                        <div class="footer-logo">
                            <a class="logo" href="#">
                                Bách Hóa Online
                            </a>
                        </div>
                        <!-- /footer logo -->

                        <p>Bách hóa online sản phẩm chính hãng, thông minh, tiện ích, ưu đãi mỗi ngày. Mua online tại Bách Hóa Online phù hợp giới tính. Với thiết kế đơn giản nhưng không thiếu đi sự tinh tế sẽ giúp bạn tìm được sản phẩm phù hợp với gia đình.</p>

                        <!-- footer social -->
                        <ul class="footer-social">
                            <li><a href="#"><i class="fa fa-facebook"></i></a></li>
                            <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="#"><i class="fa fa-instagram"></i></a></li>
                            <li><a href="#"><i class="fa fa-google-plus"></i></a></li>
                            <li><a href="#"><i class="fa fa-pinterest"></i></a></li>
                        </ul>
                        <!-- /footer social -->
                    </div>
                </div>
                <!-- /footer widget -->
                <!-- footer widget -->
                <div class="col-md-4 col-sm-6 col-xs-6">
                    <div class="footer">
                        <h3 class="footer-header">Tài khoản</h3>
                        <ul class="list-links">
                            @if (user != null)
                            {
                                <li><a href="/thong-tin-ca-nhan">Thông tin tài khoản</a></li>
                                <li><a href="#">My Wishlist</a></li>
                                <li><a href="/thong-tin-ca-nhan">Lịch sử đặt hàng</a></li>
                                <li><a href="/dang-xuat">Đăng xuất</a></li>
                            }
                            else
                            {
                                <li><a href="/dang-nhap">Đăng nhập</a></li>
                                <li><a href="/dang-ky">Đăng ký</a></li>
                            }
                        </ul>
                    </div>
                </div>
                <!-- /footer widget -->

                <div class="clearfix visible-sm visible-xs"></div>

                <!-- footer subscribe -->
                <div class="col-md-4 col-sm-6 col-xs-6">
                    <div class="footer">
                        <h3 class="footer-header">Đăng ký nhận tin</h3>
                        <p>Đăng ký để được nhận thong tin sản phẩm mới nhất từ Bách Hóa Online.</p>
                        <form>
                            <div class="form-group">
                                <input class="input" placeholder="Nhập email">
                            </div>
                            <button class="primary-btn">Đăng ký</button>
                        </form>
                    </div>
                </div>
                <!-- /footer subscribe -->
            </div>
            <!-- /row -->
            <hr>
            <!-- row -->
            <div class="row">
                <div class="col-md-8 col-md-offset-2 text-center">
                    <!-- footer copyright -->
                    <div class="footer-copyright">
                        <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                        Copyright &copy;
                        <script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
                        <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                    </div>
                    <!-- /footer copyright -->
                </div>
            </div>
            <!-- /row -->
        </div>
        <!-- /container -->
    </footer>
    <!-- /FOOTER -->

    <environment include="Development">
        <script src="~/lib/jquery/dist/jquery.js"></script>
        <script src="~/lib/bootstrap/dist/js/bootstrap.js"></script>
        <script src="~/js/site.js" asp-append-version="true"></script>
    </environment>
    <environment exclude="Development">
        <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-3.3.1.min.js"
                asp-fallback-src="~/lib/jquery/dist/jquery.min.js"
                asp-fallback-test="window.jQuery"
                crossorigin="anonymous"
                integrity="sha384-tsQFqpEReu7ZLhBV2VZlAu7zcOV+rXbYlF2cqB8txI/8aZajjp4Bqd+V6D5IgvKT">
        </script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"
                asp-fallback-src="~/lib/bootstrap/dist/js/bootstrap.min.js"
                asp-fallback-test="window.jQuery && window.jQuery.fn && window.jQuery.fn.modal"
                crossorigin="anonymous"
                integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd">
        </script>
        <script src="~/js/site.min.js" asp-append-version="true"></script>
    </environment>

    <script src="~/js/jquery.min.js"></script>
    <script src="~/js/bootstrap.min.js"></script>
    <script src="~/js/slick.min.js"></script>
    <script src="~/js/nouislider.min.js"></script>
    <script src="~/js/jquery.zoom.min.js"></script>
    <script src="~/js/main.js"></script>


    @RenderSection("Scripts", required: false)

</body>
</html>

<script>
    $('.category-header').on('click', function () {
        $('.category-list').toggle();
    });
    $('#cartt').click(function () {
        if ($('#cartt').hasClass("open")) {
            $('#cartt').removeClass("open");
            $('#cartt').attr("aria-expanded", true);
        }
        else {
            $('#cartt').addClass("open");
            $('#cartt').attr("aria-expanded", false);
        }
    });
    $('#accountt').click(function () {
        if ($('#accountt').hasClass("open")) {
            $('#accountt').removeClass("open");
            $('#accountt').attr("aria-expanded", true);
        }
        else {
            $('#accountt').addClass("open");
            $('#accountt').attr("aria-expanded", false);
        }
    });
</script>

<script>
    $(".add-to-cart").click(function () {
        var tensp = $(this).parent().parent().find(".product-name").find("a").text();
        var soluong = 1;
        if ($('#sst').length > 0) {
            soluong = $('#sst').val();
        }
        $.ajax({
            url: "/Cart/AddToCart",
            data: { "tenhh": tensp, "soluong": soluong },
            success: function (cart) {
                var htmlCartList = "";
                total = 0;
                count = 0;
                $(cart).each(function (i, item) {
                    htmlCartList += '<div class="product product-widget"><div class="product-thumb"><img src="images/' + item.hinh + '" alt=""></div>"';
                    htmlCartList += '<div class="product-body"><h3 class="product-price">' + item.dongia + '<span class="qty"> x' + item.soluong + '</span></h3>';
                    htmlCartList += '<h2 class="product-name"><a href="#">' + item.tensp + '</a></h2></div>';
                    htmlCartList += '<button class="cancel-btn"><i class="fa fa-trash"></i></button></div>';

                    total += parseInt(item.thanhTien);
                    count += 1;
                })
                $('.shopping-cart-list').html(htmlCartList);
                $('#cart-count').html(count);
                $('#cart-total').html(total);

                window.scrollTo(0, 0);
                $('#cartt').addClass("open");
                $('#cartt').attr("aria-expanded", false);
            }
        });
    });
    $('.cancel-btn').click(function () {
        var name = $(this).parent().find(".product-name").find('a').text();
        $.ajax({
            url: "/Cart/RemoveCartItem",
            data: { "itemName": name },
            success: function (cart) {
                var htmlCartList = "";
                total = 0;
                count = 0;
                $(cart).each(function (i, item) {
                    htmlCartList += '<div class="product product-widget"><div class="product-thumb"><img src="images/' + item.hinh + '" alt=""></div>"';
                    htmlCartList += '<div class="product-body"><h3 class="product-price">' + item.dongia + '<span class="qty"> x' + item.soluong + '</span></h3>';
                    htmlCartList += '<h2 class="product-name"><a href="#">' + item.tensp + '</a></h2></div>';
                    htmlCartList += '<button class="cancel-btn"><i class="fa fa-trash"></i></button></div>';

                    total += parseInt(item.thanhTien);
                    count += 1;
                })
                $('.shopping-cart-list').html(htmlCartList);
                $('#cart-count').html(count);
                $('#cart-total').html(total);
                if ($('#tbCart').length > 0)
                    location.reload();
            }
        });
    });
</script>

<!-- Subiz -->
<script>
    (function (s, u, b, i, z) {
        u[i] = u[i] || function () {
            u[i].t = +new Date();
            (u[i].q = u[i].q || []).push(arguments);
        };
        z = s.createElement('script');
        var zz = s.getElementsByTagName('script')[0];
        z.async = 1; z.src = b; z.id = 'subiz-script';
        zz.parentNode.insertBefore(z, zz);
    })(document, window, 'https://widgetv4.subiz.com/static/js/app.js', 'subiz');
    subiz('setAccount', 'acqktlssarhuxcthttib');
</script>
<!-- End Subiz -->